<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GST Billing Software</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

<style>
body{font-family:Arial;background:#f2f4f7;padding:20px}
.container{max-width:1200px;margin:auto;background:#fff;padding:20px;border-radius:10px}
input,textarea,button{padding:8px;margin:5px;border-radius:6px;border:1px solid #ccc}
button{background:#007bff;color:#fff;border:none;cursor:pointer}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:#007bff;color:#fff}
.action-btn{padding:4px 8px;font-size:12px;margin:2px}
.total{font-weight:bold;text-align:right;margin-top:5px}
</style>
</head>
<body>

<div class="container">
<h2>GST Invoice Billing Software</h2>

<h3>Seller Details</h3>
<input id="sellerName" placeholder="Store Name">
<textarea id="sellerAddress" placeholder="Store Address"></textarea>
<input id="sellerContact" placeholder="Shop Contact">
<input id="sellerGST" placeholder="GSTIN">
<input id="sellerState" placeholder="State Name">

<h3>Buyer Details</h3>
<input id="buyerName" placeholder="Buyer Name">
<textarea id="buyerAddress" placeholder="Buyer Address"></textarea>
<input id="buyerContact" placeholder="Customer Contact">
<input id="buyerGST" placeholder="Buyer GSTIN">
<input id="buyerState" placeholder="Buyer State Name">

<h3>Invoice</h3>
<input id="invoiceNo" placeholder="Invoice Number (Optional)">
<input type="date" id="invoiceDate">

<h3>Add Product</h3>
<input type="hidden" id="editIndex">
<input id="itemName" placeholder="Item Name">
<input id="hsn" placeholder="HSN Code">
<input type="number" id="qty" placeholder="Quantity">
<input type="number" id="rate" placeholder="Rate">
<input type="number" id="gstPercent" placeholder="GST %">
<button onclick="saveItem()">Save Product</button>

<table id="billTable">
<thead>
<tr>
<th>Description</th>
<th>HSN</th>
<th>Qty</th>
<th>Rate</th>
<th>GST %</th>
<th>Amount</th>
<th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div class="total">Taxable Value ₹ <span id="taxable">0</span></div>
<div class="total">CGST ₹ <span id="cgst">0</span></div>
<div class="total">SGST ₹ <span id="sgst">0</span></div>
<div class="total">IGST ₹ <span id="igst">0</span></div>
<div class="total">Grand Total ₹ <span id="grand">0</span></div>

<button onclick="downloadPDF()">Download GST Invoice PDF</button>

</div>

<script>

let items=[];
let taxable=0, cgstTotal=0, sgstTotal=0, igstTotal=0, grandTotal=0;

function saveItem(){

const name=itemName.value;
const hsnCode=hsn.value;
const quantity=parseFloat(qty.value);
const price=parseFloat(rate.value);
const gst=parseFloat(gstPercent.value)||0;
const editIndex=document.getElementById('editIndex').value;

if(!name||isNaN(quantity)||isNaN(price)) return alert("Fill product details");

const base=quantity*price;
const gstAmount=base*gst/100;

const sellerState=document.getElementById("sellerState").value.toLowerCase();
const buyerState=document.getElementById("buyerState").value.toLowerCase();

let cg=0, sg=0, ig=0;

if(sellerState && buyerState && sellerState!==buyerState){
    ig=gstAmount;
}else{
    cg=gstAmount/2;
    sg=gstAmount/2;
}

const total=base+gstAmount;

const product={name,hsnCode,quantity,price,gst,base,gstAmount,total,cg,sg,ig};

if(editIndex===""){
items.push(product);
}else{
items[editIndex]=product;
}

clearForm();
renderTable();
calculateTotals();
}

function renderTable(){
const tbody=document.querySelector("#billTable tbody");
tbody.innerHTML="";

items.forEach((item,index)=>{
const row=tbody.insertRow();
row.insertCell(0).innerText=item.name;
row.insertCell(1).innerText=item.hsnCode;
row.insertCell(2).innerText=item.quantity;
row.insertCell(3).innerText=item.price;
row.insertCell(4).innerText=item.gst+"%";
row.insertCell(5).innerText=item.total.toFixed(2);

const action=row.insertCell(6);

const editBtn=document.createElement("button");
editBtn.innerText="Edit";
editBtn.className="action-btn";
editBtn.onclick=()=>editItem(index);

const deleteBtn=document.createElement("button");
deleteBtn.innerText="Delete";
deleteBtn.className="action-btn";
deleteBtn.style.background="red";
deleteBtn.onclick=()=>deleteItem(index);

action.appendChild(editBtn);
action.appendChild(deleteBtn);
});
}

function editItem(index){
const item=items[index];
itemName.value=item.name;
hsn.value=item.hsnCode;
qty.value=item.quantity;
rate.value=item.price;
gstPercent.value=item.gst;
document.getElementById("editIndex").value=index;
}

function deleteItem(index){
if(confirm("Delete this item?")){
items.splice(index,1);
renderTable();
calculateTotals();
}
}

function clearForm(){
itemName.value="";
hsn.value="";
qty.value="";
rate.value="";
gstPercent.value="";
document.getElementById("editIndex").value="";
}

function calculateTotals(){
taxable=0; cgstTotal=0; sgstTotal=0; igstTotal=0;

items.forEach(item=>{
taxable+=item.base;
cgstTotal+=item.cg;
sgstTotal+=item.sg;
igstTotal+=item.ig;
});

grandTotal=taxable+cgstTotal+sgstTotal+igstTotal;

document.getElementById("taxable").innerText=taxable.toFixed(2);
document.getElementById("cgst").innerText=cgstTotal.toFixed(2);
document.getElementById("sgst").innerText=sgstTotal.toFixed(2);
document.getElementById("igst").innerText=igstTotal.toFixed(2);
document.getElementById("grand").innerText=grandTotal.toFixed(2);
}

function downloadPDF(){

const { jsPDF } = window.jspdf;
const doc=new jsPDF({unit:"mm",format:"a4"});

doc.setFontSize(14);
doc.text(sellerName.value||"",14,15);
doc.setFontSize(10);
doc.text(sellerAddress.value||"",14,22,{maxWidth:90});
doc.text("Contact: "+(sellerContact.value||""),14,28);
doc.text("GSTIN: "+(sellerGST.value||""),14,34);
doc.text("State: "+(sellerState.value||""),14,40);

doc.text("Invoice No: "+(invoiceNo.value||"N/A"),130,15);
doc.text("Date: "+(invoiceDate.value||""),130,22);

doc.text("Bill To:",14,55);
doc.text(buyerName.value||"",14,62);
doc.text(buyerAddress.value||"",14,68,{maxWidth:90});
doc.text("Contact: "+(buyerContact.value||""),14,76);
doc.text("GSTIN: "+(buyerGST.value||""),14,82);
doc.text("State: "+(buyerState.value||""),14,88);

doc.autoTable({
startY:95,
head:[['Description','HSN','Qty','Rate','GST %','Amount']],
body:items.map(i=>[i.name,i.hsnCode,i.quantity,i.price,i.gst+"%",i.total.toFixed(2)]),
theme:"grid"
});

let y=doc.lastAutoTable.finalY+10;

doc.text("Taxable Value: ₹ "+taxable.toFixed(2),130,y);
y+=6;
doc.text("CGST: ₹ "+cgstTotal.toFixed(2),130,y);
y+=6;
doc.text("SGST: ₹ "+sgstTotal.toFixed(2),130,y);
y+=6;
doc.text("IGST: ₹ "+igstTotal.toFixed(2),130,y);
y+=6;
doc.setFontSize(12);
doc.text("Grand Total: ₹ "+grandTotal.toFixed(2),130,y);

doc.setFontSize(9);
doc.text("This is a Computer Generated GST Invoice",14,285);

doc.save("GST_Invoice.pdf");
}

</script>
</body>
</html>
